<%- include('header') %>

  
    <main class="main">
        <div class="page-header breadcrumb-wrap">
            <div class="container">
                <div class="breadcrumb">
                    <a href="/api/user/" rel="nofollow">Home</a>
                    <span></span> Shop
                    <span></span> Filters
                </div>
            </div>
        </div>
        <section class="mt-50 mb-50">
            <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <a class="shop-filter-toogle" href="#">
                            <span class="fi-rs-filter mr-5"></span>
                            Filters
                            <i class="fi-rs-angle-small-down angle-down"></i>
                            <i class="fi-rs-angle-small-up angle-up"></i>
                        </a>
                        <div class="shop-product-fillter-header">
                            <div class="row">
                                <div class="col-lg-2 col-md-4 mb-lg-0 mb-md-5 mb-sm-5">
                                    <h5 class="mb-20">Categories</h5>
                                    <ul class="cat-list">
                                      
                                        <li class="cat-item text-muted"><a href="/api/user/CategoryFilter?category=WOMEN'S FASHION">WOMENN'S FASHION</a></li>
                                        <li class="cat-item text-muted"><a href="/api/user/CategoryFilter?category=SHOP FOR HIM">SHOP FOR HIM</a></li>
                                        <li class="cat-item text-muted"><a href="/api/user/CategoryFilter?category=PLUS SIZE FASHION">PLUS SIZE FASHION</a></li>
                                        <li class="cat-item text-muted"><a href="/api/user/CategoryFilter?category=KIDS ONLY">KIDS ONLY</a></li>
                                        <li class="cat-item text-muted"><a href="/api/user/CategoryFilter?category=ONLY MATERNITY">ONLY MATERNITY</a></li>
                      
                                    </ul>
                                </div>
                                <div class="col-lg-2 col-md-4 mb-lg-0 mb-md-5 mb-sm-5">
                                    <h5 class="mb-20">Brand</h5>
                                    <ul class="catego-list">
                                        <li class="cat-item text-muted"><a href="/api/user/brandFilter?brand=Only&cat=<%=cat%>">Only</a></li>
                                        <li class="cat-item text-muted"><a href="/api/user/brandFilter?brand=Chanel&cat=<%=cat%>">Chanel</a></li>
                                        <li class="cat-item text-muted"><a href="/api/user/brandFilter?brand=Allen Solly&cat=<%=cat%>">Allen Solly</a></li>
                                        <li class="cat-item text-muted"><a href="/api/user/brandFilter?brand=Addidas&cat=<%=cat%>">Addidas</a></li>
                                        <li class="cat-item text-muted"><a href="/api/user/brandFilter?brand=Babyhug&cat=<%=cat%>">Babyhug</a></li>
                                    </ul>
                                </div>
                                
                                <div class="col-lg-2 col-md-4 mb-lg-0 mb-md-5 mb-sm-5">
                                    <h5 class="mb-20">Price range</h5>
<ul class="categor-list">
    <li class="cat-item text-muted"><a href="/api/user/priceFilter?maxPrice=1000&price=0&cat=<%=cat%>">$0.00 - $999.99</a></li>
    <li class="cat-item text-muted"><a href="/api/user/priceFilter?maxPrice=2000&price=1000&cat=<%=cat%>">$1000.00 - $1999.99</a></li>
    <li class="cat-item text-muted"><a href="/api/user/priceFilter?maxPrice=3000&price=2000&cat=<%=cat%>">$2000.00 - $2999.99</a></li>
    <li class="cat-item text-muted"><a href="/api/user/priceFilter?maxPrice=4000&price=3000&cat=<%=cat%>">$3000.00 - $3999.99</a></li>
    <li class="cat-item text-muted"><a href="/api/user/priceFilter?maxPrice=5000&price=4000&cat=<%=cat%>">$4000.00 - $4999.99</a></li>
</ul>

                                </div>
                               
                                <div class="col-lg-2 col-md-4 mb-lg-0 mb-md-5 mb-sm-5">
                                    <h5 class="mb-20">By Color</h5>
<ul class="list-filter color-filter">
    <li><a href="/api/user/colorFilter?color=Black&cat=<%=cat%>" data-color="Black"><span class="product-color-black"></span></a></li>
    <li><a href="/api/user/colorFilter?color=Grey&cat=<%=cat%>" data-color="Grey"><span class="product-color-grey"></span></a></li>
    <li class="active"><a href="/api/user/colorFilter?color=White&cat=<%=cat%>" data-color="White"><span class="product-color-white"></span></a></li>
    <li><a href="/api/user/colorFilter?color=Orange&cat=<%=cat%>" data-color="Orange"><span class="product-color-orange"></span></a></li>
    <li><a href="/api/user/colorFilter?color=Purple&cat=<%=cat%>" data-color="Purple"><span class="product-color-purple"></span></a></li>
    <li><a href="/api/user/colorFilter?color=Green&cat=<%=cat%>" data-color="Green"><span class="product-color-green"></span></a></li>
    <li><a href="/api/user/colorFilter?color=Red&cat=<%=cat%>" data-color="Red"><span class="product-color-red"></span></a></li>
    <li><a href="/api/user/colorFilter?color=Blue&cat=<%=cat%>" data-color="Blue"><span class="product-color-blue"></span></a></li>
</ul>

                                    <h5 class="mb-15 mt-20">By Size</h5>
                                    <ul class="list-filter size-filter font-small">
                                        <a href="/api/user/sizeFilter?size=S&cat=<%=cat%>"><li>S</a></li></a>
                                        <li class="active"><a href="/api/user/sizeFilter?size=M&cat=<%=cat%>">M</a></li>
                                        <li><a href="/api/user/sizeFilter?size=L&cat=<%=cat%>">L</a></li>
                                        <li><a href="/api/user/sizeFilter?size=XL&cat=<%=cat%>">XL</a></li>
                                        <li><a href="/api/user/sizeFilter?size=XXL&cat=<%=cat%>">XXL</a></li>
                                        <li><a href="/api/user/sizeFilter?size=2XL&cat=<%=cat%>">2XL</a></li>
                                        <li><a href="/api/user/sizeFilter?size=3XL&cat=<%=cat%>">3XL</a></li>
                                    </ul



                                    
                                </div>
                             
                                
                            </div>
                            <div class="col-lg-2 col-md-4 mb-lg-0 mb-md-5 mb-sm-5">
                               
                                <ul class="clear">
                                    
                                    <li class="text-muted"><a href="/api/user/clearFilter" >Clear Filter </a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-12">
                        <div class="shop-product-fillter">
                            <div class="totall-product">
                                <p> We found <strong class="text-brand"><%=product.length %></strong> items for you!</p>
                            </div>
                            <div class="sort-by-product-area">
                                <div class="sort-by-cover mr-10">
                                    
                                   
                                </div>
                                <div class="sort-by-cover">
                                    <div class="sort-by-product-wrap">
                                        <div class="sort-by">
                                            <span><i class="fi-rs-apps-sort"></i>Sort by:</span>
                                        </div>
                                        <div class="sort-by-dropdown-wrap">
                                            <span> Featured <i class="fi-rs-angle-small-down"></i></span>
                                        </div>
                                    </div>
                                    <div class="sort-by-dropdown">
                                        <ul>
                                           
                                            <li><a href="/api/user/sortByPrice?sort=lowToHigh&cat=<%=cat%>">Price: Low to High</a></li>
                                            <li><a href="/api/user/sortByPrice?sort=highToLow&cat=<%=cat%>">Price: High to Low</a></li>
                                            <li><a href="#">Release Date</a></li>
                                          
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="row product-grid-3">
                            


                            <% if (product.length > 0) { %>

                                <% for (let i = 0; i < product.length; i++) { %>
                                    <div class="col-lg-3 col-md-4 col-12 col-sm-6">
                                        <a href="/api/user/aProduct?id=<%= product[i].id %>">
                                        <div class="product-cart-wrap mb-30">
                                            <div class="product-img-action-wrap">
                                                <div class="product-img product-img-zoom">
                                                    <a href="/api/user/aProduct?id=<%= product[i].id %>">
                                                        <img class="default-img" src="/admin/assets/imgs/category/<%= product[i].images[0] %>" alt="">
                                                        <img class="hover-img" src="/admin/assets/imgs/category/<%= product[i].images[1] %>" alt="">
                                                    </a>
                                                </div>
                                                <div class="product-action-1">
                                                  
                                                    <a
                                                    <a aria-label="Add To Wishlist" class="action-btn hover-up" onclick="wishList('<%= product[i]._id %>')"><i class="fi-rs-heart"></i></a>
                                                    <a aria-label="Compare" class="action-btn hover-up" href="#"><i class="fi-rs-shuffle"></i></a>
                                                </div>
                                                <div class="product-badges product-badges-position product-badges-mrg">
                                                    <span class="hot">Hot</span>
                                                </div>
                                            </div>
                                            <div class="product-content-wrap">
                                                <div class="product-category">
                                                    <a href="#"><%= product[i].category %></a>
                                                </div>
                                                <h2><a href="#"><%= product[i].title %></a></h2>
                                                <div class="rating-result" title="90%">
                                                    <span>
                                                        <span> </span>
                                                    </span>
                                                </div>
                                                <div class="product-price">
                                                    <span>₹<%=product[i].price  %> </span>
                                                    <span class="old-price"
                            >₹<%=product[i].price %></span
                          >
                                                    <a class="float-right" onclick="addToCart('<%= product[i].id %>')" ><i class="fi-rs-shopping-bag-add "></i></a>
                                                </div>
                                                <div class="">
                                                   
                                                </div>
                                            </div>
                                        </div>
                                    </a>
                                    </div>






                                    



                                

                                    <% } %>
                                    <% } else { %>
                                        <tr>
                                            <td colspan="2">Product not found</td>
                                        </tr>
                                        <% } %>
    
                          
                            


                            
                            
                            
                           
                        
                        </div>
                        <!--pagination-->
                        <% if (totalpages) { %>
                            <div class="pagination">
                              <% if (currentpage > 1) { %>
                                <button class="btn btn-sm"><a href="?page=<%= currentpage - 1 %>">Previous</a></button>
                              <% } %>
                          
                              <% for (let i = 1; i <= totalpages; i++) { %> <!-- Change the loop to start from 1 and go up to totalpages -->
                                <button class="btn btn-sm"><a href="?page=<%= i %>" class="<%= i === currentpage ? 'active' : '' %>"><%= i %></a></button>
                              <% } %>
                          
                              <% if (currentpage < totalpages) { %>
                                <button class="btn btn-sm"><a href="?page=<%= currentpage + 1 %>">Next</a></button>
                              <% } %>
                            </div>
                          <% } %>
                    </div>
                </div>
            </div>
        </section>
    </main>
    <script>


// //-----------------------------filter by sizee -----------------------
const sizeItems = document.querySelectorAll(".size-filter li");

// Loop through the list items and add click event listeners
sizeItems.forEach((item) => {
    item.addEventListener("click", (event) => {
        event.preventDefault();
        sizeItems.forEach((li) => {
            li.classList.remove("active");
        });
        item.classList.add("active");
        
        // Extract size from the href using URLSearchParams
        const url = new URL(item.querySelector("a").getAttribute("href"), window.location.href);
        const size = url.searchParams.get("size");

        // Handle the case where 'cat' may not be defined
        const cat = url.searchParams.get("cat");
        const catQuery = cat ? `&cat=${cat}` : '';

        window.location.href = `/api/user/sizeFilter?size=${size}${catQuery}`;
    });
});

///------------------------------filter by size end -----------------------------------------







// //--------------------------filter by color------------------------
// // Get all list items under the 'color-filter' class
const colorItems = document.querySelectorAll(".color-filter li");
colorItems.forEach((item) => {
    item.addEventListener("click", (event) => {
        event.preventDefault();
        colorItems.forEach((li) => {
            li.classList.remove("active");
        });
        item.classList.add("active");
        const color = item.querySelector("a").getAttribute("data-color");

        // Include the cat parameter from the current URL
        const currentURL = new URL(window.location.href);
        const cat = currentURL.searchParams.get("cat");
        const catQuery = cat ? `&cat=${cat}` : '';

        window.location.href = `/api/user/colorFilter?color=${color}${catQuery}`;
    });
});
























    </script>



<script>
    function wishList(id){
       $.ajax({
           url:`/api/user/addToList?id=${id}`,
           method:"get",
           success:(response)=>{
               if(response.status){
                  
               }else{
                   Swal.fire({
       title: 'ALREADY SELECTED!',
       text: 'You already selected',
       icon: 'error',
       timer: 3000,
     
   
     })
               }
   
           }
       })
   
   
   
    }
   
       </script>
       <script>
        function addToCart(id) {
          $.ajax({
            url: `/api/user/addToCart?id=${id}`,
            method: "get",
            success: (response) => {
              if (response.status) {
                Swal.fire({
                  title: "ADD TO CART",
                  text: "Product Added to cart",
                  icon: "success",
                  timer: 1000,
                  showConfirmButton: false, // This removes the button
                });
              } else {
                Swal.fire({
                  title: "OUT OFF STOK",
                  text: "The Product out off Stoke",
                  icon: "error",
                  timer: 1000,
                  showConfirmButton: false, // This removes the button
                });
              }
            },
          });
        }
      </script>



   
        <%- include('footer') %>
   